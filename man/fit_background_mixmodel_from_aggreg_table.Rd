% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_background_mixmodel_from_aggreg_table.R
\name{fit_background_mixmodel_from_aggreg_table}
\alias{fit_background_mixmodel_from_aggreg_table}
\title{Title}
\usage{
fit_background_mixmodel_from_aggreg_table(
  protect_stat_table,
  method = c("optimizing", "sampling", "vb"),
  alpha_distrbetaprior_mixcoeff = 1,
  beta_distrbetaprior_mixcoeff = 0.001,
  alpha_distrbetaprior_bg_protect = 0.1,
  beta_distrbetaprior_bg_protect = 1,
  nchains = 4,
  ncpu = nchains,
  ...
)
}
\arguments{
\item{protect_stat_table}{\code{matrix} with columns TotalGCH - total number of GCHs in a fragment, ProtectedGCH - number of protected GCHs in a fragments, 
Nfrags - number of fragments with combination of TotalGCH and ProtectedGCH.}

\item{method}{method for parameter inference that calls corresponding \code{rstan} function. 
\code{optimizing} returns point estimate corresponding to maximum in posterior denstiy.
\code{sampling} returns Hamiltonian Monte Carlo draws from posterior distribution.
\code{vb} return draws from ADVI approximation of posterior distribution (not tested yet).}

\item{alpha_distrbetaprior_mixcoeff}{alpha (shape1 in \code{rbeta}) parameter for beta prior distribution for mixing coefficient.}

\item{beta_distrbetaprior_mixcoeff}{beta (shape2 in \code{rbeta}) parameter for beta prior distribution for mixing coefficient.}

\item{alpha_distrbetaprior_bg_protect}{alpha (shape1 in \code{rbeta}) parameter for beta prior distribution for \code{bg_protect_prob}.}

\item{beta_distrbetaprior_bg_protect}{beta (shape2 in \code{rbeta}) parameter for beta prior distribution for \code{bg_protect_prob}.}

\item{nchains}{number of markov chains for \code{rstan::sampling}. Currently has no effect}

\item{ncpu}{number of cpu to use for \code{rstan::sampling}. Currently has no effect}

\item{...}{parameters for \code{rstan::optimizing}}
}
\value{
a list containing following slots:
\code{rstan_output_object} \code{rstan} objected returned by function \code{optimizing}.
\code{background_model_params} list containing parameters for function which performs footprint inference, i.e. \code{nomeR::infer_footprints_stan_sampling}.
The list \code{background_model_params} contains 3 values:
\code{bg_protect_prob_fixed} inferred value for background probability to emit protected base, i.e. \code{bg_protect_prob}.
bg_protect_prior_alpha alpha (shape1 in \code{rbeta}) parameter for beta distribution which will be used as a prior distribution for \code{bg_protect_prob} in function for footprint inference.
bg_protect_prior_beta beta (shape2 in \code{rbeta}) parameter for beta distribution which will be used as a prior distribution for \code{bg_protect_prob} in function for footprint inference.
}
\description{
Title
}
