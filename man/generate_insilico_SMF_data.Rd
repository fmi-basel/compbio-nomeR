% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/generate_insilico_SMF_data.R
\name{generate_insilico_SMF_data}
\alias{generate_insilico_SMF_data}
\title{Generate in-silico single-molecule footprinting dataset}
\usage{
generate_insilico_SMF_data(
  region_len,
  n_reads,
  footprint_models,
  ftp_emission_posprob = NULL,
  bgprotectprob,
  infposdens = 1
)
}
\arguments{
\item{region_len}{length of the region}

\item{n_reads}{number of molecule to generate}

\item{footprint_models}{\code{list} describing footprints which should be generated. Each footprint within footprint_models is also a \code{list} that must contain
\code{PROTECT_PROB} - vector of emission probabilities with same length and footprint length;
\code{COVER_PROB} - \code{numeric} that describes footprint coverage
\code{NAME} - \code{character} with the name of the footprint}

\item{ftp_emission_posprob}{\code{matrix} describing positional probabilities for each footprint. Number of rows must be equal to number of footprints and number of columns must be equal to \code{region_len}}

\item{bgprotectprob}{\code{numeric} emission probability for background}

\item{infposdens}{if scalar between 0 and 1 treated as percentage of informative positions.
If a vector of integers treated as predefined informative positions.}
}
\value{
\code{list} that contains
"DATA" - \code{matrix} with in-silico data;
"TRUE_CONF" - true positions for each footprint;
"ftp_pos_prob" -normalized probabilities of placing each footprint.
}
\description{
Generate in-silico single-molecule footprinting dataset
}
\examples{
\dontrun{
## length of a chromosome
chr_len <- 1000

ftp_cover_c2 <- c(0.05,0.5)
ftp_len_c2 <- c(50,150)
case2_pos_mat <- rbind(matrix(c(rep(0,5150),1,rep(0,4849)),nrow=1,ncol=chr_len),
											 matrix(1/chr_len,nrow=1,ncol=chr_len))

## sequencing depths
max_nreads <- 30
## footprint model
case2_ftp_models <- list("ftp50" = list("PROTECT_PROB" = rep(1,ftp_len_c2[1]),
																				"COVER_PRIOR" = ftp_cover_c2[1],
																				"NAME" = "ftp50"),
												 "ftp150"=list("PROTECT_PROB" = rep(1,ftp_len_c2[2]),
												 							"COVER_PRIOR" = ftp_cover_c2[2],
												 							"NAME" = "ftp150"))

smf_data <- generate_insilico_SMF_data(region_len = chr_len, # length of the region
																			n_reads = max_nreads, # number of reads
																			footprint_models = case2_ftp_models,
																			ftp_emission_posprob=case2_pos_mat, ## matrix with nrow=number ftps ncol=ampllen for each footprint to describe
																			## probabilities of emission for each amplicon position
																			bgprotectprob = 0,
																			infposdens = 1 # if scalar between 0 and 1 treated as percentage of informative positions
																			# if vector of integers treated as predefined informative positions
																			)

}



}
