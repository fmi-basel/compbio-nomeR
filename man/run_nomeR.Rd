% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/nomeR-package.R
\name{run_nomeR}
\alias{run_nomeR}
\title{Function for running probabilistic model to predict binding sites of DNA binding proteins in NOMe-Seq data}
\usage{
run_nomeR(data, binding_models, bgprotectprob, bgprior,
  bound_fit_tol = 1e-05, bound_min_fderiv_val = 1e-05,
  bound_max_steps = 1000, run_priorEM = FALSE,
  priorEM_fit_tol = 1e-05, priorEM_max_steps = 1000)
}
\arguments{
\item{data}{A list containing preprocessed NOMe-Seq data returned from \code{create_data_list}.}

\item{binding_models}{A list containing binding models for proteins. 
Each element must have 3 slots:
PROTECT_PROB - a numeric vector with probability to find protected 'C' within the footprint
PRIOR - prior (numeric) probability reflecting how often we expect to find a footprint
NAME - name (character) of a model, e.g. "Nucleosome"}

\item{bgprotectprob}{probability to find a protected 'C' in open (uprotected) regions}

\item{bgprior}{prior probability for a free (unprotected, or background) position}

\item{bound_fit_tol}{fitting tolerance for estimating initial values of partition sums}

\item{bound_min_fderiv_val}{This value used in Haley's numerical method for solving equations and represent a 
minimal value of denominator in first derivative of a function}

\item{bound_max_steps}{Maximum number of iterations for algorithm which estimates boundary values for partition sums}

\item{run_priorEM}{If TRUE the function runs Expectation Maximization algorithm for fitting prior probabilities of binding objects.
Not recommended for regions with transcription factor binding as the EM overestimates shorter footprints}

\item{priorEM_fit_tol}{Fitting tolerance for running prior EM}

\item{priorEM_max_steps}{Maximum number of iterations in prior EM}
}
\value{
A list which contains 3 data frames:
        \code{START_PROB} - data frame with calculated start probabilities for each NOME-Seq fragment (column \code{seq}),
                            each position in the amplicon (column \code{pos}) and each binding model, e.g. Nucleosome, background etc.
                            These probabilities reflect how likely it is to find a start in each fragment and at each position of a certain bidning model.
         
        \code{COVER_PROB} - data frame with calculated coverage probabilities for each NOME-Seq fragment (column \code{seq}),
                            each position in the amplicon (column \code{pos}) and each binding model, e.g. Nucleosome, background etc.
                            These probabilities reflect how likely it is that a certain position in an amplicon and certain fragment is covered by a certain bidning model.

        \code{SUMMARY} - data frame with summary information for each binding model and for the whole amplicon.
                         Column \code{Statistics} contains the following information:
                         
                         \code{Prior} - empirical prior probabilities for each model.
                         \code{Expected number of sites} - expected number of sites for each model, i.e. sum of all start probabilities.
                         \code{Coverage} - average coverage of the amiplicon.
                         \code{Sites<0.5} - expected number of sites with start probabilities lower than 0.5.
                         \code{Sites>=0.5} - expected number of sites with start probabilities higher than 0.5.
                         \code{Positions<0.5} - number of positions with start probabilities lower than 0.5.
                         \code{Positionds>=} - number of positions with start probabilities higher than 0.5.
}
\description{
Function for running probabilistic model to predict binding sites of DNA binding proteins in NOMe-Seq data
}
\examples{


}
