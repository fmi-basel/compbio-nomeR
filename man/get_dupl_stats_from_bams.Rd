% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_dupl_stats_from_bams.R
\name{get_dupl_stats_from_bams}
\alias{get_dupl_stats_from_bams}
\title{Fetch statistics of duplicated fragments}
\usage{
get_dupl_stats_from_bams(
  bamfiles,
  samplenames,
  regions,
  genome,
  collapseBySample = TRUE,
  mapqMin = 0,
  mapqMax = 255,
  max_read_size = 1000L,
  ncores = 1L
)
}
\arguments{
\item{bamfiles}{\code{character} paths to bam files}

\item{samplenames}{\code{character} names of samples. If \code{collapseBySample} is \code{TRUE} counts are aggregated across bam files with same sample name.}

\item{regions}{\linkS4class{GRanges} object for regions of interest.}

\item{genome}{\code{character} path to fasta file which was used as reference for alignment.}

\item{collapseBySample}{\code{logical} indicating whether to collapse counts for bam files with same \code{samplenames}. If \code{FALSE} prefix \code{s} followed by index is added to \code{samplenames}.}

\item{mapqMin}{\code{integer} setting minimum MAPQ of reads to be included into analysis.}

\item{mapqMax}{\code{integer} setting maximum MAPQ of reads to be included into analysis.}

\item{max_read_size}{maximum read length.}

\item{ncores}{number of cores to use.}
}
\value{
\code{tibble} where each row corresponds to sample - region combination. 
Columns of the returned \code{tibble} represent:
\describe{
  \item{SampleName}{Name of a sample as defined by \code{samplenames}.}
  \item{seqnames, start, end}{seqnames (or chromosomes) and coordinates of corresponding regions.}
  \item{names}{the same as \code{names(regions)} if it is not \code{NULL} or index of a corresponding region in \code{regions}.}
  \item{nFragsFetched}{number of fetched fragments before filtering.}
  \item{nFragsNonUnique}{number of non-unique fragments as defined by coordinates and methylation profiles.}
  \item{duplStatsMatrix}{\code{matrix} with 2 columns. First column represents (\code{n_uniq_aln}) number of unique alignments after deduplication and second 
  column (\code{n_times_duplicated}) represents number of times each of the alignments was duplicated.
  For example, row with numbers 100 at the first column and 1 at the second column should be interpreted as following: 100 alignments in the data has exactly 1 unique fragment.
  In other words, 100 fragments are unique.
  Another example, row with numbers 200 at the first column and 5 at the second column means that before deduplication 5 alignments were supported by 200 duplicated fragments each.
  }
  \item{duplFragNamesList}{\code{list} of vectors containing names of duplicated fragments. Names of list elements are encodings of unique alignments and can be ignored.
  }
}
}
\description{
Fetch statistics of duplicated fragments
}
